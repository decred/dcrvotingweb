<!-- CAUTION: This is a professionally uglified proof-of-concept by karamble. Base for discussion, let me know your thoughts. -->
{{define "home"}}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Hardfork Demo of Decred Cryptocurrency">
    <meta name="author" content="Decred Developer">
    <link rel="icon" href="favicon.ico">
    <title>Hardfork Demo</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <!--  Custom favicon  -->
    <link rel="apple-touch-icon" sizes="180x180" href="./content/images/favicon/apple-touch-icon.png?v=fi5jKKtbwv">
    <link rel="icon" type="image/png" href="./content/images/favicon/favicon-32x32.png?v=fi5jKKtbwv" sizes="32x32">
    <link rel="icon" type="image/png" href="./content/images/favicon/favicon-16x16.png?v=fi5jKKtbwv" sizes="16x16">
    <link rel="manifest" href="./content/images/favicon/manifest.json?v=fi5jKKtbwv">
    <link rel="mask-icon" href="./content/images/favicon/safari-pinned-tab.svg?v=fi5jKKtbwv">
    <link rel="shortcut icon" href="./content/images/favicon/favicon.ico?v=fi5jKKtbwv">
    <meta name="apple-mobile-web-app-title" content="deCRED - decentralised credit">
    <meta name="application-name" content="deCRED - decentralised credit">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="js/Chart.min.js"></script>
  </head>
  <body>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top" id="navbar">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">
            <svg class="svg-logo">
              <use xlink:href="images/sprites.svg#svg-decred-logo" />
            </svg>
          </a>
        </div>
      </div>
    </nav>
    <div class="container">
      <br />
      <br />
      <br />
      <h1>Decred Hardfork Demonstration on Testnet</h1>
      <!-- INTRODUCTION TEXT -->
      <div class="row">
        <div class="col-md-6">
          <p>
            Once the majority of the PoW miners have upgraded ({{.BlockVersionRejectThreshold}}% of the {{.BlockVersionWindowLength}} most recent blocks are at the latest version) 
            and the majority of the PoS miners ({{.StakeVersionThreshold}}% of the votes in a {{.StakeVersionWindowLength}} block window) have upgraded, the voting process begins.
          </p>
        </div>
        <!-- OVERALL STATISTICS -->
        <div class="col-md-6">
          <blockquote>
            Network Block Version: v{{.CurrentCalculatedBlockVersion}}
            <br />
            Current Block Height: {{.BlockHeight}}
            <br />
            Most popular version (v{{.MostPopularVersion}}) percentage: <span style="color:#2ED6A1;">{{.MostPopularVersionPercentage}}%</span>
            <br />
            PoS Miners on latest Votebits: <span style="color:#FD714A;">XX%</span>
          </blockquote>
        </div>
      </div>
      <!-- BEGIN STEP 1 BLOCK AND VOTEBIT VERSION TRESHOLD 95% -->
      <h4><span>Step 1</span></h4>
      <!-- BEGIN POW TRESHOLD CHART 144 BLOCKS WINDOW DATAPOINTS -->
      <div class="row">
        <div class="col-md-8">
          <h3>Block Version (PoW)</h3>
          <p>Block Versions generated by PoW miners.</p>
          <!-- FIRST CHART -->
          <canvas id="blockVersions" width="400" height="200"></canvas>
        </div>
        <!-- BEGIN POW BAR LAST 144 BLOCKS -->
        <div class="col-md-4">
          <canvas id="blockVersionsIndicator" width="400" height="510"></canvas>
        </div>
      </div>
      <!-- 95% Treshold reached alertbox -->
      <div class="row">
        <div class="col-md-12">
          <br />
          <br />
          <div class="alert alert-success">
            <strong>Success!</strong> During the last {{.BlockVersionWindowLength}} Blocks we have reached the minimum of {{.BlockVersionRejectThreshold}}% Blocks which are on the latest Block Version <strong>vX</strong>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-8">
          <h3>Stake Version (PoS)</h3>
          <p>Votebit Versions generated by PoS Miners</p>
          <!-- SECOND CHART VOTE VERSIONS / SVI -->
          <div style="width: 100%; height:350px;">
            <canvas id="voteVersions" width="400" height="200"></canvas>
          </div>
        </div>
        <!-- BEGIN POW BAR LAST 144 BLOCKS -->
        <div class="col-md-4">
          <canvas id="voteVersionsIndicator" width="400" height="510"></canvas>
        </div>
      </div>
      <!-- 95% Treshold reached alertbox -->
      <div class="row">
        <div class="col-md-12">
          <br /><br />
          <div class="alert alert-danger">
            <strong>Danger!</strong> PoS Miners please upgrade your Software. XX% of the Votes during the XX Blocks Window are outdated.
          </div>
        </div>
      </div>
      <br />
      <br />
      <br />
      <br />
      <!-- BEGIN STEP 1 BLOCK AND VOTEBIT VERSION TRESHOLD 95% -->
      <h4><span>Step 2</span></h4>
      <!-- INTRODUCTION TEXT -->
      <div class="row">
        <div class="col-md-6">
          <p>After the network made sure that {{.BlockVersionRejectThreshold}}% of the PoW and {{.StakeVersionThreshold}}% of the PoS Miners are update the actual Voting on a Agenda can take place.</p>
          <p>On Testnet we have a Voting Window of {{.RuleChangeActivationWindow}} Blocks (around one Week). In this time there can be made {{.RuleChangeActivationWindowVotes}} Votes (5 votes per Block).</p>
          <p>Users can vote either yes, no or abstain. The wallet abstains per default, users have to set their votebits on purpose.</p>
          <p>We have a Quorum of {{.QuorumPercentage}}%. This means a minimum of {{.RuleChangeActivationQuorum}} votes have to be done ({{.QuorumPercentage}}% of all votes during the voting window) and have to vote either YES or NO. Otherwise the voting  is invalid.</p>
          <p>When less than {{.QuorumPercentage}}% actively placed a vote the voting is canceled and will be reinitiated until the expiration date</p>
          <h3>Quorum:</h3>
          <!-- QUORUM HORIZONTAL BARCHART -->
          <canvas id="voteQuorum" width="400" height="100"></canvas>
          <div class="alert alert-danger">
            <strong>Danger!</strong> We have yet not reached the minimum Quorum of 10% actively made votes.
          </div>
        </div>
        <!-- OVERALL STATISTICS -->
        <div class="col-md-6">
          <blockquote>Agenda ID: #{{.AgendaID}}
            <br />
            Agenda Title: {{.AgendaDescription}}
            <br />
            Voting Window: Block {{.VoteStartHeight}}-{{.VoteEndHeight}}
            <br />
            Blocks left for voting: {{.VoteBlockLeft}}
            <br />
            Estimated Vote Expiration Block: {{.VoteExpirationBlock}}
            <h3>Voting Progress:</h3>
            <canvas id="voteProgress" width="100" height="100"></canvas>
          </blockquote>
        </div>
      </div>
    </div> <!-- /container -->

  <!-- blockVersions line chart-->
  <script>
    var blockVersionGraphColors = ['23,12,220','244,100,1','75,192,192','41,113,255']

    var blockVersionsLineConfig = {
      type: 'line',
      data: {
        labels: {{.BlockVersionsHeights}},
        datasets: [
        {{range $i, $element := .BlockVersions}}
          {
              label: "Block v"+{{$i}},
              fill: true,
              lineTension: 0.1,
              backgroundColor: "rgba("+blockVersionGraphColors[{{$i}}-1]+",0.4)",
              borderColor: "rgba("+blockVersionGraphColors[{{$i}}-1]+",1)",
              borderCapStyle: 'butt',
              borderDash: [],
              borderDashOffset: 0.0,
              borderJoinStyle: 'miter',
              pointBorderColor: "rgba("+blockVersionGraphColors[{{$i}}-1]+",1)",
              pointBackgroundColor: "#fff",
              pointBorderWidth: 1,
              pointHoverRadius: 5,
              pointHoverBackgroundColor: "rgba("+blockVersionGraphColors[{{$i}}-1]+",1)",
              pointHoverBorderColor: "rgba(220,220,220,1)",
              pointHoverBorderWidth: 2,
              pointRadius: 1,
              pointHitRadius: 10,
              data: {{.RollingWindowLookBacks}},
              spanGaps: false,
          },
        {{end}}
          ]
      },
      options: {
        title: {
          display: true,
          text: 'PoW Block Versions',
          fontColor: '#FFF'
        },
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero:true,
              fontColor: '#FFF'
            }
          }],
          xAxes: [{
            ticks: {
              autoSkipPadding: 50,
              beginAtZero:true,
              fontColor: '#FFF',
              reverse: true,
            }
          }]
        }
      }
    };
    var ctx = document.getElementById("blockVersions");
    var myChart = new Chart(ctx, blockVersionsLineConfig);

    // blockVersions most recent bar chart
    var blockVersionsBarConfig = {
      type: 'bar',
      data: {
        labels: ["Last {{.BlockVersionWindowLength}} Blocks"],
        datasets: [
        {{range $i, $element := .BlockVersions}}
        {{$length := minus (len $element.RollingWindowLookBacks) 1}}
          {
          type: 'bar',
          label: 'Block v{{$i}}',
          backgroundColor: "rgba("+blockVersionGraphColors[{{$i}}-1]+",1)",
          data: [{{index $element.RollingWindowLookBacks $length}}],
          }, 
        {{end}}
        ]
      },
      options: {
        scales: {
          xAxes: [{
            stacked: true
          }],
          yAxes: [{
            stacked: true
          }]
        }
      }
    };
    var ctx = document.getElementById("blockVersionsIndicator").getContext("2d");
    new Chart(ctx, blockVersionsBarConfig);
    // vote version line graph
    var voteVersionGraphColors = ['23,12,220','244,100,1','75,192,192','41,113,255']

    var voteVersionLineConfig = {
      type: 'line',
      data: {
        labels: {{.StakeVersionHeights}},
        datasets: [
          {{range $i, $element := .StakeVersions}}
          {
            label: "Votebits v{{$i}}",
            fill: true,
            lineTension: 0.1,
            backgroundColor: "rgba("+voteVersionGraphColors[{{$i}}]+",0.4)",
            borderColor: "rgba("+voteVersionGraphColors[{{$i}}]+",1)",
            borderCapStyle: 'butt',
            borderDash: [],
            borderDashOffset: 0.0,
            borderJoinStyle: 'miter',
            pointBorderColor: "rgba("+voteVersionGraphColors[{{$i}}]+",1)",
            pointBackgroundColor: "#fff",
            pointBorderWidth: 1,
            pointHoverRadius: 5,
            pointHoverBackgroundColor: "rgba("+voteVersionGraphColors[{{$i}}]+",1)",
            pointHoverBorderColor: "rgba(220,220,220,1)",
            pointHoverBorderWidth: 2,
            pointRadius: 1,
            pointHitRadius: 10,
            data: {{.StaticWindowVoteCounts}},
            spanGaps: false,
          },
          {{end}}
        ]
      },
      options: {
        title: {
          display: true,
          text: 'Vote Versions / SVI / Stake version Interval',
          fontColor: '#FFF'
        },
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero:true,
              fontColor: '#FFF',
              suggestedMin: 0,
              suggestedMax: {{.StakeVersionWindowVoteTotal}}
            }
          }],
          xAxes: [{
            ticks: {
              beginAtZero:true,
              fontColor: '#FFF'
            }
          }]
        }
      }
    };
    var cty = document.getElementById("voteVersions");
    var myChart = new Chart(cty, voteVersionLineConfig);

    var voteVersionBarConfig = {
      type: 'bar',
      data: {
        labels: ["Totals for Block {{.BlockHeight}}"],
        datasets: [
        {{range $i, $element := .StakeVersions}}
          {
          type: 'bar',
          label: 'Block v{{$i}}',
          backgroundColor: "rgba("+voteVersionGraphColors[{{$i}}]+",1)",
          data: [{{$element.CurrentTotalVotes}}],
          }, 
        {{end}}
        ]
      },
      options: {
        scales: {
          xAxes: [{
            stacked: true,
            suggestedMin: 0,
            suggestedMax: {{.StakeVersionWindowVoteTotal}}
          }],
          yAxes: [{
            stacked: true,
            suggestedMin: 0,
            suggestedMax: {{.StakeVersionWindowVoteTotal}}
          }]
        }
      }
    };
    var ctx = document.getElementById("voteVersionsIndicator").getContext("2d");
    new Chart(ctx, voteVersionBarConfig);

    var quorumHorizontalConfig = {
      type: 'horizontalBar',
      data: {
      labels: ["Voted vs. Abstained"],
        datasets: [{
          type: 'horizontalBar',
          label: 'Voted',
          data: [{{.QuorumVotedPercentage}}],
          backgroundColor: '#41BF53',
          }, {
          type: 'horizontalBar',
          label: 'Abstained',
          data: [{{.QuorumAbstainedPercentage}}],
          backgroundColor: '#FD714A'
        }] 
      },
      options: {
        scales: {
          xAxes: [{
            display: true,
            ticks: {
              suggestedMin: 0,
              suggestedMax: 100,
            }
          }]
        }
      }
    };
    var cta = document.getElementById("voteQuorum");
    new Chart(cta, quorumHorizontalConfig);

    var quorumDonutConfig = {
      type: 'doughnut',
      data: {
      labels: {{.ChoiceIds}},
        datasets: [{
          data: {{.ChoicePercentages}},
          backgroundColor: [
            "#FD714A",
            "#41BF53",
            "#69D3F5"
          ],
          hoverBackgroundColor: [
            "#0C1E3E",
            "#2ED6A1",
            "#2971FF"
          ]
        }]
      }
    };
    var ctu = document.getElementById("voteProgress");
    new Chart(ctu, quorumDonutConfig);
  </script>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery.min.js"><\/script>')</script>
    <script src="js/bootstrap.min.js"></script>

  </body>
</html>
{{end}}
